\doxysection{base\+\_\+game.\+hpp}
\hypertarget{base__game_8hpp_source}{}\label{base__game_8hpp_source}\index{lib\_base\_game/include/base\_game.hpp@{lib\_base\_game/include/base\_game.hpp}}
\mbox{\hyperlink{base__game_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{game_8hpp}{sokoban\_core/game.hpp}}"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{game__action_8hpp}{sokoban\_core/game\_action.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tile_8hpp}{sokoban\_core/tile.hpp}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tile__map_8hpp}{sokoban\_core/tile\_map.hpp}}"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{coords_8hpp}{sokoban\_core/coords.hpp}}"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{direction_8hpp}{sokoban\_core/direction.hpp}}"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{base__action__factory_8hpp}{base\_action\_factory.hpp}}"{}}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <tuple>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacesokoban}{sokoban}}\ \{}
\DoxyCodeLine{00014\ \textcolor{keyword}{namespace\ }sbg\ \{}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game}{BaseGame}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classsokoban_1_1_game}{Game}}}
\DoxyCodeLine{00017\ \{}
\DoxyCodeLine{00018\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_aa200581675491b81edfa637c0c5c8ef3}{BaseGame}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00020\ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a473f115a1bb16f208bafa465b1f8079e}{BaseGame}}(\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map}{RectangleTileMap}}\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_ab041525e66edc6b5d5a694e0af8312f4}{map}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_coords}{Coords}}\&\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a9588845c4f2c298f6409e88809fac343}{playerCoords}})\ :\ map\_\ \{\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_ab041525e66edc6b5d5a694e0af8312f4}{map}}\ \},\ playerCoords\_\ \{\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a9588845c4f2c298f6409e88809fac343}{playerCoords}}\ \}\ \{\}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{namespacesokoban_accb61aac9fefeabbbde4aa418f98cc3c}{GameState}}\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_ae6912f1d9d6cd4cade643f51b45174ee}{gameState}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00023\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ row\ :\ map\_)\ \{}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}\ :\ row)\ \{}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ targetIter\ =\ std::find\_if(\mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}.\mbox{\hyperlink{classsokoban_1_1_tile_ae7951b4b9e68be16cf39c4861251b946}{begin}}(),\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}.\mbox{\hyperlink{classsokoban_1_1_tile_a703b879e5e8e0a5802d1b5d77f30837d}{end}}(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \textcolor{keywordtype}{object})\ \{}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ object-\/>id()-\/>id()\ ==\ \textcolor{stringliteral}{"{}target"{}};}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (targetIter\ !=\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}.\mbox{\hyperlink{classsokoban_1_1_tile_a703b879e5e8e0a5802d1b5d77f30837d}{end}}())\ \{}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ crateIter\ =\ std::find\_if(\mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}.\mbox{\hyperlink{classsokoban_1_1_tile_ae7951b4b9e68be16cf39c4861251b946}{begin}}(),\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}.\mbox{\hyperlink{classsokoban_1_1_tile_a703b879e5e8e0a5802d1b5d77f30837d}{end}}(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \textcolor{keywordtype}{object})\ \{}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ object-\/>id()-\/>id()\ ==\ \textcolor{stringliteral}{"{}crate"{}};}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (crateIter\ ==\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}.\mbox{\hyperlink{classsokoban_1_1_tile_a703b879e5e8e0a5802d1b5d77f30837d}{end}}())\ \{}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesokoban_accb61aac9fefeabbbde4aa418f98cc3ca12d868c18cb29bf58f02b504be9033fd}{GameState::InProgress}};}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesokoban_accb61aac9fefeabbbde4aa418f98cc3ca19abd416eb9fe03ae7400a22446956a5}{GameState::Won}};}
\DoxyCodeLine{00041\ \ \ \ \ \}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a03774d08ee05103d881c1c79154bbd37}{setMap}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map}{RectangleTileMap}}\&\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_ab041525e66edc6b5d5a694e0af8312f4}{map}})\ \{\ map\_\ =\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_ab041525e66edc6b5d5a694e0af8312f4}{map}};\ \}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a984ff4978f348ee6442f9ec37300da96}{setPlayerCoords}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_coords}{Coords}}\&\ coords)\ \{\ playerCoords\_\ =\ coords;\ \}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a53d1d0e25a9aeee7ef2511d603083e05}{moveObject}}(std::shared\_ptr<GameObject>\ \textcolor{keywordtype}{object},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_coords}{Coords}}\&\ sourceCoords,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_coords}{Coords}}\&\ targetCoords)}
\DoxyCodeLine{00045\ \ \ \ \ \{}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_a033af4fd2e391864c7b3b5081b9ca58c}{moveObject}}(\textcolor{keywordtype}{object},\ sourceCoords,\ targetCoords);}
\DoxyCodeLine{00047\ \ \ \ \ \}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_afa1c5dad920b9e4195ad4e9989d1710e}{tileIsMovable}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_tile}{Tile}}\&\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}})}
\DoxyCodeLine{00049\ \ \ \ \ \{}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \textcolor{keywordtype}{object}\ :\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}})\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*object-\/>id()\ ==\ \textcolor{stringliteral}{"{}player"{}})\ ||\ (*\textcolor{keywordtype}{object}-\/>id()\ ==\ \textcolor{stringliteral}{"{}crate"{}})\ ||\ (*object-\/>id()\ ==\ \textcolor{stringliteral}{"{}wall"{}}))\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00057\ \ \ \ \ \}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_adb48a7b0c69de22fb9d936c33003ba62}{moveObject}}(\mbox{\hyperlink{namespacesokoban_aa4808be624db9a7898d2cc3661560d06}{GameObjectSptr}}\ \textcolor{keywordtype}{object},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_coords}{Coords}}\&\ coords,\ \mbox{\hyperlink{namespacesokoban_ab3f2dbcce0c78c98f9da3b9d0736b139}{Direction}}\ direction)}
\DoxyCodeLine{00059\ \ \ \ \ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ nextTile\ =\ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_ae16dd0fb29299d66ae5ca58664b4377b}{adjacentTile}}(coords,\ direction);}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!nextTile.has\_value())\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_afa1c5dad920b9e4195ad4e9989d1710e}{tileIsMovable}}(nextTile.value()))\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ sourceTile\ =\ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_af3db0dcd3e17b1435b1ff2fd778a6912}{tile}}(coords);}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \ \ \ \ \ \ \ iter\ \ \ \ \ \ \ =\ std::find(sourceTile.objects().begin(),\ sourceTile.objects().end(),\ \textcolor{keywordtype}{object});}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (iter\ !=\ sourceTile.objects().cend())\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ nextCoords\ =\ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_af4b16e66f7eb0472cd7f774c41324a66}{adjacentCoords}}(coords,\ direction);}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nextCoords.has\_value())\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_a033af4fd2e391864c7b3b5081b9ca58c}{moveObject}}(\textcolor{keywordtype}{object},\ coords,\ nextCoords.value());}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00079\ \ \ \ \ \}}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_aa79705e137687f80ef9f9b3212e55627}{movePlayer}}(\mbox{\hyperlink{namespacesokoban_ab3f2dbcce0c78c98f9da3b9d0736b139}{Direction}}\ direction)}
\DoxyCodeLine{00081\ \ \ \ \ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ nextTile\ =\ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_ae16dd0fb29299d66ae5ca58664b4377b}{adjacentTile}}(playerCoords\_,\ direction);}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!nextTile.has\_value())\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}\ =\ nextTile.value();}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \textcolor{keywordtype}{object}\ :\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}.get())\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (object-\/>id()-\/>id()\ ==\ \textcolor{stringliteral}{"{}wall"{}})\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ hasCrate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \textcolor{keywordtype}{object}\ :\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}.get())\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (object-\/>id()-\/>id()\ ==\ \textcolor{stringliteral}{"{}crate"{}})\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ nextCoords\ =\ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_af4b16e66f7eb0472cd7f774c41324a66}{adjacentCoords}}(playerCoords\_,\ direction);}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hasCrate\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ !\mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a53d1d0e25a9aeee7ef2511d603083e05}{moveObject}}(\textcolor{keywordtype}{object},\ nextCoords.value(),\ direction);}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (hasCrate)\ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ playerTile\ =\ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_af3db0dcd3e17b1435b1ff2fd778a6912}{tile}}(playerCoords\_);}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \ \ \ \ \ \ \ iter\ =\ std::find\_if(playerTile.objects().begin(),\ playerTile.objects().end(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ iter)\ \{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ return\ iter-\/>id()-\/>id()\ ==\ \textcolor{stringliteral}{"{}player"{}};}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (iter\ !=\ playerTile.objects().cend())\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \ \ \ \ \ \ \ player\ \ \ \ \ =\ *iter;}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ nextCoords\ =\ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_af4b16e66f7eb0472cd7f774c41324a66}{adjacentCoords}}(playerCoords\_,\ direction);}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!nextCoords.has\_value())\ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ success\ =\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a53d1d0e25a9aeee7ef2511d603083e05}{moveObject}}(player,\ playerCoords\_,\ direction);}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (success)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ playerCoords\_\ =\ nextCoords.value();}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00124\ \ \ \ \ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map}{RectangleTileMap}}\&\ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_ab041525e66edc6b5d5a694e0af8312f4}{map}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ map\_;\ \}}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_tile}{Tile}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a0cdecf4272deca8d626ebff2dab14577}{tile}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_coords}{Coords}}\&\ coords)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ map\_.\mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_ad0c776e1911b7b77f7e10a2b263558db}{map}}()[coords.\mbox{\hyperlink{classsokoban_1_1_coords_af791f6042cf7f56f17689013f39cb3a2}{y}}()][coords.\mbox{\hyperlink{classsokoban_1_1_coords_a1ce876d305e0e8f9cd74c8cb451cd7cb}{x}}()];\ \}}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_coords}{Coords}}\&\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_game_a9588845c4f2c298f6409e88809fac343}{playerCoords}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ playerCoords\_;\ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00131\ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map}{RectangleTileMap}}\ \ map\_;}
\DoxyCodeLine{00132\ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1_coords}{Coords}}\ \ \ \ \ \ \ \ \ \ \ \ playerCoords\_;}
\DoxyCodeLine{00133\ \ \ \ \ \mbox{\hyperlink{namespacesokoban_accb61aac9fefeabbbde4aa418f98cc3c}{GameState}}\ \ \ \ \ \ \ \ \ gameState\_\ =\ \mbox{\hyperlink{namespacesokoban_accb61aac9fefeabbbde4aa418f98cc3ca12d868c18cb29bf58f02b504be9033fd}{GameState::InProgress}};}
\DoxyCodeLine{00134\ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1sbg_1_1_base_action_factory}{BaseActionFactory}}\ actionFactory\_;}
\DoxyCodeLine{00135\ \};}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \textcolor{keyword}{inline}\ std::pair<RectangleTileMap,\ Coords>\ \mbox{\hyperlink{namespacesokoban_1_1sbg_a8f2cb47f845eab09db6625dc0078f300}{loadLevelMap}}(\textcolor{keyword}{const}\ std::filesystem::path\&\ path,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_game_object_factory}{GameObjectFactory}}\&\ \ \ \ \ objectFactory)}
\DoxyCodeLine{00139\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keyword}{auto}\ file\ =\ std::ifstream\ \{\ path\ \};}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordflow}{if}\ (!file.is\_open())\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Failed\ to\ open\ path\ "{}}\ +\ path.string());}
\DoxyCodeLine{00143\ \ \ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ std::string\ \ \ \ \ \ \ \ \ \ \ symbolsToIgnore\ =\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00146\ \ \ \ \ std::vector<RectangleTileMap::Row>\ map;}
\DoxyCodeLine{00147\ \ \ \ \ std::optional<Coords>\ \ \ \ \ \ \ \ \ \ \ \ \ \ playerCoords\_;}
\DoxyCodeLine{00148\ \ \ \ \ std::string\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ line;}
\DoxyCodeLine{00149\ \ \ \ \ std::size\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rowsCount\ =\ 0;}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordflow}{while}\ (std::getline(file,\ line))\ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_a32c274f2e67cf5fe2fc1ff7cc3670f96}{RectangleTileMap::Row}}\ row(line.size());}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (std::size\_t\ i\ =\ 0;\ i\ <\ line.size();\ ++i)\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (symbolsToIgnore.find(line[i])\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ objects\ =\ objectFactory.\mbox{\hyperlink{classsokoban_1_1_game_object_factory_ae1e15a5757283ab648f8377f6a3d0698}{create}}(line[i]);}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \textcolor{keywordtype}{object}\ :\ objects)\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*object-\/>id()\ ==\ \textcolor{stringliteral}{"{}player"{}})\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ playerCoords\_\ =\ \{\ i,\ rowsCount\ \};}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ row[i].setObjects(std::move(objects));}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ map.push\_back(std::move(row));}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ ++rowsCount;}
\DoxyCodeLine{00166\ \ \ \ \ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\ \mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map}{RectangleTileMap}}\ \{\ std::move(map)\ \},\ playerCoords\_.value()\ \};}
\DoxyCodeLine{00169\ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \textcolor{keyword}{inline}\ std::tuple<RectangleTileMap,\ Coords,\ std::size\_t>\ \mbox{\hyperlink{namespacesokoban_1_1sbg_a1238dcead3fe6a0c1302e28fa0267093}{loadSaveGame}}(\textcolor{keyword}{const}\ std::filesystem::path\&\ path,}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_game_object_factory}{GameObjectFactory}}\&\ \ \ \ \ objectFactory)}
\DoxyCodeLine{00173\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{keyword}{auto}\ file\ =\ std::ifstream\ \{\ path\ \};}
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keywordflow}{if}\ (!file.is\_open())\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Failed\ to\ open\ path\ "{}}\ +\ path.string());}
\DoxyCodeLine{00177\ \ \ \ \ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ std::size\_t\ level\ =\ 0;}
\DoxyCodeLine{00180\ \ \ \ \ file\ >>\ level;}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ std::string\ \ \ \ \ \ \ \ \ \ \ symbolsToIgnore\ =\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00183\ \ \ \ \ std::vector<RectangleTileMap::Row>\ map;}
\DoxyCodeLine{00184\ \ \ \ \ std::optional<Coords>\ \ \ \ \ \ \ \ \ \ \ \ \ \ playerCoords\_;}
\DoxyCodeLine{00185\ \ \ \ \ std::string\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ line;}
\DoxyCodeLine{00186\ \ \ \ \ std::size\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rowsCount\ =\ 0;}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordflow}{while}\ (std::getline(file,\ line))\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_a32c274f2e67cf5fe2fc1ff7cc3670f96}{RectangleTileMap::Row}}\ row(line.size());}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (std::size\_t\ i\ =\ 0;\ i\ <\ line.size();\ ++i)\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (symbolsToIgnore.find(line[i])\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ objects\ =\ objectFactory.\mbox{\hyperlink{classsokoban_1_1_game_object_factory_ae1e15a5757283ab648f8377f6a3d0698}{create}}(line[i]);}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \textcolor{keywordtype}{object}\ :\ objects)\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*object-\/>id()\ ==\ \textcolor{stringliteral}{"{}player"{}})\ \{}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ playerCoords\_\ =\ \{\ i,\ rowsCount\ \};}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ row[i].setObjects(std::move(objects));}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ map.push\_back(std::move(row));}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ ++rowsCount;}
\DoxyCodeLine{00203\ \ \ \ \ \}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\ \mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map}{RectangleTileMap}}\ \{\ std::move(map)\ \},\ playerCoords\_.value(),\ level\ \};}
\DoxyCodeLine{00206\ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \textcolor{keyword}{inline}\ std::tuple<RectangleTileMap,\ Coords,\ std::size\_t>\ \mbox{\hyperlink{namespacesokoban_1_1sbg_a1238dcead3fe6a0c1302e28fa0267093}{loadSaveGame}}(std::istream\&\ file,}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsokoban_1_1_game_object_factory}{GameObjectFactory}}\&\ \ \ \ \ objectFactory)}
\DoxyCodeLine{00210\ \{}
\DoxyCodeLine{00211\ \ \ \ \ std::size\_t\ level\ =\ 0;}
\DoxyCodeLine{00212\ \ \ \ \ file\ >>\ level;}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ std::string\ \ \ \ \ \ \ \ \ \ \ symbolsToIgnore\ =\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00215\ \ \ \ \ std::vector<RectangleTileMap::Row>\ map;}
\DoxyCodeLine{00216\ \ \ \ \ std::optional<Coords>\ \ \ \ \ \ \ \ \ \ \ \ \ \ playerCoords\_;}
\DoxyCodeLine{00217\ \ \ \ \ std::string\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ line;}
\DoxyCodeLine{00218\ \ \ \ \ std::size\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rowsCount\ =\ 0;}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keywordflow}{while}\ (std::getline(file,\ line))\ \{}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map_a32c274f2e67cf5fe2fc1ff7cc3670f96}{RectangleTileMap::Row}}\ row(line.size());}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (std::size\_t\ i\ =\ 0;\ i\ <\ line.size();\ ++i)\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (symbolsToIgnore.find(line[i])\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ objects\ =\ objectFactory.\mbox{\hyperlink{classsokoban_1_1_game_object_factory_ae1e15a5757283ab648f8377f6a3d0698}{create}}(line[i]);}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \textcolor{keywordtype}{object}\ :\ objects)\ \{}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*object-\/>id()\ ==\ \textcolor{stringliteral}{"{}player"{}})\ \{}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ playerCoords\_\ =\ \{\ i,\ rowsCount\ \};}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ row[i].setObjects(std::move(objects));}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ map.push\_back(std::move(row));}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ ++rowsCount;}
\DoxyCodeLine{00235\ \ \ \ \ \}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\ \mbox{\hyperlink{classsokoban_1_1_rectangle_tile_map}{RectangleTileMap}}\ \{\ std::move(map)\ \},\ playerCoords\_.value(),\ level\ \};}
\DoxyCodeLine{00238\ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \}\ \textcolor{comment}{//\ namespace\ sbg}}
\DoxyCodeLine{00241\ \}\ \textcolor{comment}{//\ namespace\ sokoban}}

\end{DoxyCode}
